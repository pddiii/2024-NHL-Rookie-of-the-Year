inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId)
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId)
calder_odds <-
data.frame(playerId = as.factor(c(8482079, 8482122, 8482684, 8484144, 8484166)),
odds = c(1200, 350, 750, -190, 1400))
calder_odds <-
calder_odds %>%
mutate(implied_probability = ifelse(playerId == 8484144, (odds / (odds + 100)) * 100,
(100 / (odds + 100)) * 100))
calder_odds
calder_odds <-
data.frame(playerId = as.factor(c(8482079, 8482122, 8482684, 8484144, 8484166)),
odds = c(1200, 350, 750, -190, 1400))
calder_odds <-
calder_odds %>%
mutate(implied_probability = ifelse(playerId == 8484144, (abs(odds) / (abs(odds) + 100)) * 100,
(100 / (odds + 100)) * 100))
calder_odds
calder_odds <-
data.frame(playerId = as.factor(c(8482079, 8482122, 8482684, 8484144, 8484166)),
odds = c(1200, 350, 750, -190, 1400))
calder_odds <-
calder_odds %>%
mutate(win_probability = ifelse(playerId == 8484144, abs(odds) / (abs(odds) + 100),
100 / (odds + 100)))
calder_odds
calder_odds <-
data.frame(playerId = as.factor(c(8482079, 8482122, 8482684, 8484144, 8484166)),
odds = c(1200, 350, 750, -190, 1400))
calder_odds <-
calder_odds %>%
mutate(win_probability = round(ifelse(playerId == 8484144, abs(odds) / (abs(odds) + 100),
100 / (odds + 100)), 4))
calder_odds
install.packages("formattable")
library(formattable)
knitr::opts_chunk$set(echo = TRUE)
source("Visualizations and Data Cleaning.R")
library(formattable)
formattable(calder_odds)
install.packages("kableExtra")
knitr::opts_chunk$set(echo = TRUE)
source("Visualizations and Data Cleaning.R")
library(kableExtra)
calder_odds %>%
kbl()
calder_odds %>%
kbl() %>% kable_paper()
calder_odds %>%
kbl() %>%
kable_paper() %>%
column_spec(2, color = spec_color(calder_odds$odds[1:5]))
calder_stats
calder_odds <-
data.frame(playerId = as.factor(c(8482079, 8482122, 8482684, 8484144, 8484166)),
odds = c(1200, 350, 750, -190, 1400))
calder_odds <-
calder_odds %>%
mutate(win_probability = round(ifelse(playerId == 8484144, abs(odds) / (abs(odds) + 100),
100 / (odds + 100)), 4))
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
arrange(desc(win_probability))
test <- c("+350")
as.numeric(test)
calder_odds <-
data.frame(playerId = as.factor(c(8482079, 8482122, 8482684, 8484144, 8484166)),
odds = c("+1200", "+350", "+750", "-190", "+1400"))
calder_odds <-
calder_odds %>%
mutate(win_probability = round(ifelse(playerId == 8484144, abs(as.numeric(odds)) / (abs(as.numeric(odds)) + 100),
100 / (as.numeric(odds) + 100)), 4))
calder_odds
calder_odds <-
data.frame(playerId = as.factor(c(8482079, 8482122, 8482684, 8484144, 8484166)),
odds = c("+1200", "+350", "+750", "-190", "+1400"))
calder_odds <-
calder_odds %>%
mutate(win_probability = round(ifelse(playerId == 8484144, abs(as.numeric(odds)) / (abs(as.numeric(odds)) + 100),
100 / (as.numeric(odds) + 100)), 4)) %>%
arrange(desc(win_probability))
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId)
calder_stats
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId) %>%
arrange(desc(win_probability))
calder_stats
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl()
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper()
setwd("/Users/PeterDePaul/Downloads/2024-NHL-Rookie-of-the-Year")
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper() %>%
column_spec(1, image = c('/Player Info/connor_bedard.png')))
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper() %>%
column_spec(1, image = c('/Player Info/connor_bedard.png') )
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper() %>%
column_spec(1, image = "/Player Info/connor_bedard.png" )
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper() %>%
column_spec(1, image = "/Player Info/connor_bedard.png" )
calder_stats %>%
select(Name, odds, win_probability) %>%
slice(n = 1)
calder_stats %>%
select(Name, odds, win_probability) %>%
slice(1)
calder_stats %>%
select(Name, odds, win_probability) %>%
slice(1)
mutate(player_image = "", .before = Name)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard")
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard")
mutate(player_image = "", .before = Name)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper() %>%
column_spec(1, image = "/Player Info/connor_bedard.png" )
column_spec(1, image = spec_image("/Player Info/connor_bedard.png", 50, 50)
calder_stats %>%
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper() %>%
column_spec(1, image = spec_image("/Player Info/connor_bedard.png", 50, 50))
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper() %>%
column_spec(1, image = "/Users/PeterDePaul/Downloads/2024-NHL-Rookie-of-the-Year/Player Info/connor_bedard.png")
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper()
knitr::opts_chunk$set(include = FALSE)
source("Visualizations and Data Cleaning.R")
library(kableExtra)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper()
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper()
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
source("Visualizations and Data Cleaning.R")
library(kableExtra)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper()
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
source("Visualizations and Data Cleaning.R")
library(tidyverse)
library(kableExtra)
calder_stats %>%
select(Name, odds, win_probability) %>%
filter(Name == "Connor Bedard") %>%
mutate(player_image = "", .before = Name) %>%
kbl(booktabs = T) %>%
kable_paper()
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = F)
setwd("~/Downloads/2024-NHL-Rookie-of-the-Year")
alder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = F)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = F)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = FALSE) %>%
column_spec(1, image = image_paths, width = "7cm", border_left = T,
border_right = T) %>%
column_spec(2, width = "4cm") %>%
column_spec(3, width = "2.5cm") %>%
column_spec(4, width = "2.5cm")
image_paths <-
c("/Users/PeterDePaul/Downloads/2024-NHL-Rookie-of-the-Year/Player Info/connor_bedard.png", "/Users/PeterDePaul/Downloads/2024-NHL-Rookie-of-the-Year/Player Info/brock_faber.png", "/Users/PeterDePaul/Downloads/2024-NHL-Rookie-of-the-Year/Player Info/luke_hughes.png", "/Users/PeterDePaul/Downloads/2024-NHL-Rookie-of-the-Year/Player Info/marco_rossi.png", "/Users/PeterDePaul/Downloads/2024-NHL-Rookie-of-the-Year/Player Info/adam_fantilli.png")
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = FALSE) %>%
column_spec(1, image = image_paths, width = "7cm", border_left = T,
border_right = T) %>%
column_spec(2, width = "4cm") %>%
column_spec(3, width = "2.5cm") %>%
column_spec(4, width = "2.5cm")
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = FALSE) %>%
column_spec(1, image = image_paths, width = "7cm", border_left = T,
border_right = T) %>%
column_spec(2, width = "4cm", border_right = T) %>%
column_spec(3, width = "2.5cm", border_right = T) %>%
column_spec(4, width = "2.5cm", border_right = T)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = FALSE) %>%
column_spec(1, image = image_paths, width = "7cm", border_left = T,
border_right = T) %>%
column_spec(2, width = "4cm", border_right = T, background = "lightblue") %>%
column_spec(3, width = "2.5cm", border_right = T) %>%
column_spec(4, width = "2.5cm", border_right = T)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(player_image = "", .before = Name) %>%
kbl() %>%
kable_paper(full_width = FALSE) %>%
column_spec(1, image = image_paths, width = "7cm", border_left = T,
border_right = T) %>%
column_spec(2, width = "4cm", border_right = T, background = "lightblue") %>%
column_spec(3, width = "2.5cm", border_right = T, background = "lightblue") %>%
column_spec(4, width = "2.5cm", border_right = T, background = "lightblue")
calder_stats
calder_stats %>%
select(-17:18)
calder_stats %>%
select(-c(17:18))
calder_stats %>%
select(-c(1, 17:18))
calder_stats %>%
select(-c(1, 17:18), -shorthandedGoals, -shorthandedPoints) %>%
kbl() %>%
kable_paper(full_width = TRUE)
calder_stats %>%
select(-c(1, 17:18), -shorthandedGoals, -shorthandedPoints)
calder_stats %>%
select(-1, -shorthandedGoals, -shorthandedPoints)
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
source("Visualizations and Data Cleaning.R")
library(tidyverse)
library(kableExtra)
calder_stats %>%
select(-1, -shorthandedGoals, -shorthandedPoints)
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId) %>%
arrange(desc(win_probability)) %>%
mutate(gpg = round(goals / games, 4),
apg = round(assists / games, 4),
ppg = round(points / games, 4),
spg = round(shots / games, 4))
calder_stats %>%
select(-1, -shorthandedGoals, -shorthandedPoints, -odds,
-win_probability)
calder_stats %>%
select(-1, -shorthandedGoals, -shorthandedPoints, -odds,
-win_probability)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(Image = "", .before = Name) %>%
rename(Odds = odds,
`Implied Probability` = win_probability)
calder_stats %>%
select(Name, odds, win_probability) %>%
mutate(Image = "", .before = Name) %>%
rename(Odds = odds,
`Implied Probability` = win_probability) %>%
mutate(`Implied Probability` = `Implied Probability` * 100)
str_c(c(calder_stats$win_probability, "%"))
str_c(c(calder_stats$win_probability), sep = " ", collapse = "%")
str_c(calder_stats$win_probability %>% as.character(), "%")
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId) %>%
arrange(desc(win_probability)) %>%
mutate(gpg = round(goals / games, 4),
apg = round(assists / games, 4),
ppg = round(points / games, 4),
spg = round(shots / games, 4)) %>%
rename(Odds = odds,
`Implied Probability` = win_probability) %>%
mutate(`Implied Probability` = `Implied Probability` * 100)
str_c(calder_stats$win_probability %>% as.character(), "%")
str_c(calder_stats$`Implied Probability` %>% as.character(), "%")
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
source("Visualizations and Data Cleaning.R")
library(tidyverse)
library(kableExtra)
calder_stats %>%
select(Name, odds, `Implied Probability`)
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId) %>%
arrange(desc(win_probability)) %>%
mutate(gpg = round(goals / games, 4),
apg = round(assists / games, 4),
ppg = round(points / games, 4),
spg = round(shots / games, 4)) %>%
rename(Odds = odds,
`Implied Probability` = win_probability) %>%
mutate(`Implied Probability` = `Implied Probability` * 100)
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId) %>%
arrange(desc(win_probability)) %>%
mutate(gpg = round(goals / games, 4),
apg = round(assists / games, 4),
ppg = round(points / games, 4),
spg = round(shots / games, 4)) %>%
rename(Odds = odds,
`Implied Probability` = win_probability) %>%
mutate(`Implied Probability` = `Implied Probability` * 100)
calder_stats %>%
select(Name, odds, `Implied Probability`)
calder_stats %>%
select(Name, Odds, `Implied Probability`)
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId) %>%
arrange(desc(win_probability)) %>%
mutate(gpg = round(goals / games, 4),
apg = round(assists / games, 4),
ppg = round(points / games, 4),
spg = round(shots / games, 4)) %>%
rename(Odds = odds,
`Implied Probability` = win_probability) %>%
mutate(`Implied Probability` = `Implied Probability` * 100,
`Implied Probability` = str_c(as.character(`Implied Probability`, "%")))
calder_stats %>%
select(Name, Odds, `Implied Probability`)
# Stats for the Calder Candidates as of 02/09/2024
calder_stats <-
calder_games %>%
group_by(playerId) %>%
summarise_if(is.numeric, sum) %>%
inner_join(skaters_info %>% select(playerId, Name), by = "playerId") %>%
inner_join(calder_odds, by = "playerId") %>%
relocate(Name, .after = playerId) %>%
arrange(desc(win_probability)) %>%
mutate(gpg = round(goals / games, 4),
apg = round(assists / games, 4),
ppg = round(points / games, 4),
spg = round(shots / games, 4)) %>%
rename(Odds = odds,
`Implied Probability` = win_probability) %>%
mutate(`Implied Probability` = `Implied Probability` * 100,
`Implied Probability` = str_c(as.character(`Implied Probability`), "%"))
calder_stats %>%
select(Name, Odds, `Implied Probability`)
412 / 512
100 / 7767
calder_stats %>%
select(-1, -shorthandedGoals, -shorthandedPoints, -Odds,
-`Implied Probability`)
gpg_plot_w_names
library(patchwork)
gpg_plot_w_names + apg_plot_w_names
ppg_plot_w_names + pm_plot_w_names
rookie_stats %>%
select(Name, seasonId, teamAbbrev, positionCode, team_points, team_wins) %>%
filter(Name %in% c("Connor McDavid", "Connor Bedard", "Sydney Crosby",
"Alex Ovechkin", "Patrick Kane"))
rookie_stats %>%
select(Name, seasonId, teamAbbrev, positionCode, team_points, team_wins) %>%
filter(Name %in% c("Connor McDavid", "Connor Bedard", "Sidney Crosby",
"Alex Ovechkin", "Patrick Kane"))
toi_plot_w_names
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
source("Visualizations and Data Cleaning.R")
library(tidyverse)
library(kableExtra)
library(patchwork)
calder_stats
